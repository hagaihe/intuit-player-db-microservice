2024-08-28 14:38:43,500 - PlayerDBMicroservice - INFO - Logger initialized.
2024-08-28 14:38:43,600 - PlayerDBMicroservice - INFO - 19370 players exists in source csv file.
2024-08-28 14:38:48,165 - root - ERROR - Invalid 'limit' value: 19370. set to default max: 200.
2024-08-28 14:38:48,168 - aiohttp.access - INFO - 127.0.0.1 [28/Aug/2024:13:38:48 +0200] "GET /api/players?page=1&limit=19370 HTTP/1.1" 200 100494 "-" "PostmanRuntime/7.40.0"
2024-08-28 14:39:46,895 - root - ERROR - Invalid 'page' value: 20000. Total pages available: 1937.
2024-08-28 14:39:46,896 - aiohttp.access - INFO - 127.0.0.1 [28/Aug/2024:13:39:46 +0200] "GET /api/players?page=20000&limit=10 HTTP/1.1" 400 229 "-" "PostmanRuntime/7.40.0"
2024-08-28 14:39:57,469 - aiohttp.access - INFO - 127.0.0.1 [28/Aug/2024:13:39:57 +0200] "GET /api/players?page=1937&limit=10 HTTP/1.1" 200 5174 "-" "PostmanRuntime/7.40.0"
2024-08-28 14:40:40,844 - aiohttp.access - INFO - 127.0.0.1 [28/Aug/2024:13:40:40 +0200] "GET /api/players?page=19370&limit=1 HTTP/1.1" 200 705 "-" "PostmanRuntime/7.40.0"
2024-08-28 14:40:53,395 - aiohttp.access - INFO - 127.0.0.1 [28/Aug/2024:13:40:53 +0200] "GET /api/players?page=0&limit=1 HTTP/1.1" 400 217 "-" "PostmanRuntime/7.40.0"
2024-08-28 14:41:03,195 - aiohttp.access - INFO - 127.0.0.1 [28/Aug/2024:13:41:03 +0200] "GET /api/players?page=1&limit=1 HTTP/1.1" 200 708 "-" "PostmanRuntime/7.40.0"
2024-08-28 16:38:44,940 - PlayerDBMicroservice - INFO - Logger initialized.
2024-08-28 16:38:44,940 - root - ERROR - Error reading from CSV file: 'playerID'
Traceback (most recent call last):
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 45, in _index_generator
    yield row['playerID'], position  # yield the playerID and its position
KeyError: 'playerID'
2024-08-28 16:38:44,940 - root - ERROR - Error while indexing & counting player records: 'playerID'
Traceback (most recent call last):
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 31, in _build_index_and_count
    async for player_id, position in self._index_generator():
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 49, in _index_generator
    raise e
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 45, in _index_generator
    yield row['playerID'], position  # yield the playerID and its position
KeyError: 'playerID'
2024-08-28 16:38:44,940 - PlayerDBMicroservice - CRITICAL - Failed to load players data: 'playerID'
2024-08-28 16:38:44,940 - asyncio - ERROR - unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-1' coro=<_run_app() done, defined at C:\Users\hagai\PycharmProjects\intuit_assignment\venv\lib\site-packages\aiohttp\web.py:300> exception=SystemExit(1)>
Traceback (most recent call last):
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\main.py", line 24, in init_app
    await players_db.load_players('data/players.csv')
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 23, in load_players
    await self._build_index_and_count()
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 36, in _build_index_and_count
    raise e
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 31, in _build_index_and_count
    async for player_id, position in self._index_generator():
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 49, in _index_generator
    raise e
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 45, in _index_generator
    yield row['playerID'], position  # yield the playerID and its position
KeyError: 'playerID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\venv\lib\site-packages\aiohttp\web.py", line 518, in run_app
    loop.run_until_complete(main_task)
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\base_events.py", line 629, in run_until_complete
    self.run_forever()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\base_events.py", line 596, in run_forever
    self._run_once()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\base_events.py", line 1890, in _run_once
    handle._run()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\venv\lib\site-packages\aiohttp\web.py", line 322, in _run_app
    app = await app
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\main.py", line 27, in init_app
    raise SystemExit(1)
SystemExit: 1
2024-08-28 16:39:00,377 - PlayerDBMicroservice - INFO - Logger initialized.
2024-08-28 16:39:00,377 - root - ERROR - Error reading from CSV file: 'playerID'
Traceback (most recent call last):
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 45, in _index_generator
    yield row['playerID'], position  # yield the playerID and its position
KeyError: 'playerID'
2024-08-28 16:39:00,377 - root - ERROR - Error while indexing & counting player records: 'playerID'
Traceback (most recent call last):
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 31, in _build_index_and_count
    async for player_id, position in self._index_generator():
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 49, in _index_generator
    raise e
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 45, in _index_generator
    yield row['playerID'], position  # yield the playerID and its position
KeyError: 'playerID'
2024-08-28 16:39:00,377 - PlayerDBMicroservice - CRITICAL - Failed to load players data: 'playerID'
2024-08-28 16:39:00,377 - asyncio - ERROR - unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-1' coro=<_run_app() done, defined at C:\Users\hagai\PycharmProjects\intuit_assignment\venv\lib\site-packages\aiohttp\web.py:300> exception=SystemExit(1)>
Traceback (most recent call last):
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\main.py", line 24, in init_app
    await players_db.load_players('data/players.csv')
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 23, in load_players
    await self._build_index_and_count()
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 36, in _build_index_and_count
    raise e
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 31, in _build_index_and_count
    async for player_id, position in self._index_generator():
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 49, in _index_generator
    raise e
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 45, in _index_generator
    yield row['playerID'], position  # yield the playerID and its position
KeyError: 'playerID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\venv\lib\site-packages\aiohttp\web.py", line 518, in run_app
    loop.run_until_complete(main_task)
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\base_events.py", line 629, in run_until_complete
    self.run_forever()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\base_events.py", line 596, in run_forever
    self._run_once()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\base_events.py", line 1890, in _run_once
    handle._run()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\venv\lib\site-packages\aiohttp\web.py", line 322, in _run_app
    app = await app
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\main.py", line 27, in init_app
    raise SystemExit(1)
SystemExit: 1
2024-08-28 16:39:37,081 - PlayerDBMicroservice - INFO - Logger initialized.
2024-08-28 16:41:12,767 - PlayerDBMicroservice - CRITICAL - Failed to load players data: 'NoneType' object is not callable
2024-08-28 16:41:12,767 - asyncio - ERROR - unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-1' coro=<_run_app() done, defined at C:\Users\hagai\PycharmProjects\intuit_assignment\venv\lib\site-packages\aiohttp\web.py:300> exception=SystemExit(1)>
Traceback (most recent call last):
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 45, in _index_generator
    yield row['playerID'], position  # yield the playerID and its position
KeyError: 'playerID'

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 31, in _build_index_and_count
    async for player_id, position in self._index_generator():
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 48, in _index_generator
    logging.exception(f"Error reading from CSV file: {e}")
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 48, in _index_generator
    logging.exception(f"Error reading from CSV file: {e}")
  File "_pydevd_bundle\pydevd_cython_win32_39_64.pyx", line 1179, in _pydevd_bundle.pydevd_cython_win32_39_64.SafeCallWrapper.__call__
  File "_pydevd_bundle\pydevd_cython_win32_39_64.pyx", line 620, in _pydevd_bundle.pydevd_cython_win32_39_64.PyDBFrame.trace_dispatch
  File "_pydevd_bundle\pydevd_cython_win32_39_64.pyx", line 1095, in _pydevd_bundle.pydevd_cython_win32_39_64.PyDBFrame.trace_dispatch
  File "_pydevd_bundle\pydevd_cython_win32_39_64.pyx", line 1057, in _pydevd_bundle.pydevd_cython_win32_39_64.PyDBFrame.trace_dispatch
  File "_pydevd_bundle\pydevd_cython_win32_39_64.pyx", line 317, in _pydevd_bundle.pydevd_cython_win32_39_64.PyDBFrame.do_wait_suspend
  File "C:\Program Files\JetBrains\PyCharm Community Edition 2021.2.2\plugins\python-ce\helpers\pydev\pydevd.py", line 1147, in do_wait_suspend
    self._do_wait_suspend(thread, frame, event, arg, suspend_type, from_this_thread)
  File "C:\Program Files\JetBrains\PyCharm Community Edition 2021.2.2\plugins\python-ce\helpers\pydev\pydevd.py", line 1162, in _do_wait_suspend
    time.sleep(0.01)
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:/Users/hagai/PycharmProjects/intuit_assignment/app/main.py", line 24, in init_app
    await players_db.load_players('data/players.csv')
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 23, in load_players
    await self._build_index_and_count()
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\app\db_handler.py", line 31, in _build_index_and_count
    async for player_id, position in self._index_generator():
TypeError: 'NoneType' object is not callable

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\venv\lib\site-packages\aiohttp\web.py", line 518, in run_app
    loop.run_until_complete(main_task)
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\base_events.py", line 629, in run_until_complete
    self.run_forever()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\windows_events.py", line 316, in run_forever
    super().run_forever()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\base_events.py", line 596, in run_forever
    self._run_once()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\base_events.py", line 1890, in _run_once
    handle._run()
  File "C:\Users\hagai\AppData\Local\Programs\Python\Python39\lib\asyncio\events.py", line 80, in _run
    self._context.run(self._callback, *self._args)
  File "C:\Users\hagai\PycharmProjects\intuit_assignment\venv\lib\site-packages\aiohttp\web.py", line 322, in _run_app
    app = await app
  File "C:/Users/hagai/PycharmProjects/intuit_assignment/app/main.py", line 24, in init_app
    await players_db.load_players('data/players.csv')
SystemExit: 1
2024-08-28 16:41:59,435 - PlayerDBMicroservice - INFO - Logger initialized.
2024-08-28 16:41:59,525 - PlayerDBMicroservice - INFO - 19370 players exists in source csv file.
2024-09-01 11:10:15,788 - PlayerDBMicroservice - INFO - Logger initialized.
2024-09-01 11:10:25,350 - PlayerDBMicroservice - INFO - 19370 players exists in source csv file.
2024-09-01 11:11:53,529 - aiohttp.access - INFO - 127.0.0.1 [01/Sep/2024:10:10:52 +0200] "GET /api/players HTTP/1.1" 200 55882 "-" "PostmanRuntime/7.41.2"
2024-09-01 11:13:04,980 - aiohttp.access - INFO - 127.0.0.1 [01/Sep/2024:10:12:56 +0200] "GET /api/players?page=5&limit=50 HTTP/1.1" 200 7690 "-" "PostmanRuntime/7.41.2"
2024-09-01 11:13:13,909 - PlayerDBMicroservice - INFO - Logger initialized.
2024-09-01 11:13:14,000 - PlayerDBMicroservice - INFO - 19370 players exists in source csv file.
2024-09-01 11:13:18,117 - aiohttp.access - INFO - 127.0.0.1 [01/Sep/2024:10:13:18 +0200] "GET /api/players?page=5&limit=50 HTTP/1.1" 200 7690 "-" "PostmanRuntime/7.41.2"
2024-09-01 11:20:55,671 - PlayerDBMicroservice - INFO - Logger initialized.
2024-09-01 11:20:55,783 - PlayerDBMicroservice - INFO - 19370 players exists in source csv file.
2024-09-01 11:21:05,258 - aiohttp.access - INFO - 127.0.0.1 [01/Sep/2024:10:21:05 +0200] "GET /api/players/abbated01 HTTP/1.1" 200 639 "-" "PostmanRuntime/7.41.2"
2024-09-01 11:21:10,355 - aiohttp.access - INFO - 127.0.0.1 [01/Sep/2024:10:21:10 +0200] "GET /api/players HTTP/1.1" 200 55882 "-" "PostmanRuntime/7.41.2"
2024-09-01 11:21:15,374 - aiohttp.access - INFO - 127.0.0.1 [01/Sep/2024:10:21:15 +0200] "GET /api/players/abbated01 HTTP/1.1" 200 639 "-" "PostmanRuntime/7.41.2"
2024-09-01 11:21:18,590 - aiohttp.access - INFO - 127.0.0.1 [01/Sep/2024:10:21:18 +0200] "GET /api/players HTTP/1.1" 200 55882 "-" "PostmanRuntime/7.41.2"
